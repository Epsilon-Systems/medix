jQuery(document).ready(function(jQuery){$=jQuery;var stringVersionJs="";"undefined"!=typeof nbExtensionVersion&&(stringVersionJs="?v="+nbExtensionVersion);var queue=[baseNameUrl+"libraries/noboss/assets/util/js/min/reactivatesubformfields.min.js",baseNameUrl+"libraries/noboss/assets/util/js/min/blockfields.min.js",baseNameUrl+"libraries/noboss/assets/util/js/min/fields.min.js","https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.js",baseNameUrl+"libraries/noboss/assets/plugins/stylesheets/css/jquery-confirm.min.css"].map(function(script){return"js"===script.slice(-2)&&0===jQuery("script[src*='"+script.slice(-30)+"']").length?jQuery("head").append('<script type="text/javascript" src="'+(-1!=script.indexOf("noboss")?script+stringVersionJs:script)+'"><\/script>'):"css"===script.slice(-3)&&0===jQuery("link[href*='"+script.slice(-30)+"']").length?jQuery("head").append('<link rel="stylesheet" href="'+(-1!=script.indexOf("noboss")?script+stringVersionJs:script)+'"/>'):void 0});jQuery.when.apply(null,queue).done(function(){var nTimer;nTimer=setInterval(function(){void 0!=jQuery().confirm&&(clearInterval(nTimer),nobossmodal.CONSTRUCTOR())},50)})});var nobossmodal={loadCss:[],loadJs:[],CONSTRUCTOR:function(){jconfirm.defaults={draggable:!1,useBootstrap:!0,animateFromElement:!1,columnClass:"modal-confirm-responsive"},nobossmodal.infos=Joomla.getOptions("nobossmodal"),jQuery("#module-form, #form-group").off("focusout change"),jQuery("body").on("click","[data-id=noboss-modal]",nobossmodal.loadModal),jQuery("#module-form, #form-group").on("submit",nobossmodal.interceptFormSubmit),jQuery("body").on("click","[data-id=modal] [data-id=button-confirm]:not([disabled])",nobossmodal.confirmModal),jQuery("body").on("click","[data-id=modal] [data-id=button-cancel]",nobossmodal.cancelModal),jQuery("body").on("click","[data-id=modal] [data-id=button-reset]:not([disabled])",nobossmodal.resetModal),jQuery("body").on("click","[data-id=modal] [data-id=modal-nav-tabs] [data-id=modal-tab]",nobossmodal.tabNavigation)},interceptFormSubmit:function(event){},loadModal:function(event){event.preventDefault();var that=jQuery(this);if(jQuery(that).attr("disabled"))return!1;var modalElem=jQuery(that).siblings("[data-id=modal]");if(0===modalElem.length){nobossmodal.addLoader(jQuery(that));var jsonData=jQuery(that).siblings("[data-id=noboss-modal-input-hidden]").val(),modalName=jQuery(that).siblings("[data-id=noboss-modal-input-hidden]").data("modal-name"),xmlPath=jQuery(that).siblings("[data-id=noboss-modal-input-hidden]").data("formsource");nobossmodal.ajaxAndInsertModal(that,jsonData,modalName,xmlPath).done(function(response){nobossmodal.openModal(jQuery(that).siblings("[data-id=modal]"))})}else nobossmodal.openModal(modalElem)},addLoader:function(el){nobossmodal.disableButtons(!0);var loaderEl=jQuery('<div class="loader loader--side"></div>');jQuery(el).after(loaderEl)},removeLoader:function(){jQuery(".loader.loader--side").remove(),nobossmodal.disableButtons(!1)},disableButtons:function(option){jQuery("[data-id=noboss-modal]:visible").attr("disabled",option)},ajaxAndInsertModal:function(that,jsonData,modalName,xmlPath){nobossmodal.blockModal=0,"undefined"!=typeof nobosslicense&&void 0!=nobosslicense.licenseInfo&&void 0!=nobosslicense.licenseInfo.data.fields_block&&""!=nobosslicense.licenseInfo.data.fields_block&&-1!=nobosslicense.licenseInfo.data.fields_block.indexOf("[modal-complete]["+modalName+"]")&&(nobossmodal.blockModal=1);var themeValue=jQuery("[data-id=theme-modal-input]").val();return jQuery.ajax({url:baseNameUrl+"administrator/index.php?option=com_nobossajax&library=noboss.forms.fields.nobossmodal.nobossmodal&method=loadModal&lang="+codeLanguage,data:{data:jsonData,modalName:modalName,xmlPath:xmlPath,blockModal:nobossmodal.blockModal,valuefieldid:that.siblings("[data-id=noboss-modal-input-hidden]").data("valuefieldid"),theme:themeValue},type:"POST"}).done(function(response){nobossmodal.removeLoader();var modalElem=jQuery(response).insertAfter(that);nobossmodal.addFilesAndReactivateFields(modalElem),nbfields.tooltips(modalElem)}).fail(function(e){jQuery.alert({title:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CONNECTION_ERROR_TITLE+" "+e.status+": "+e.statusText,content:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CONNECTION_ERROR_CONTENT,buttons:{ok:function(){nobossmodal.removeLoader()}}})})},addFilesAndReactivateFields:function(modalElem){nobossmodal.loadCss.map(function(file){if(-1===file.url.indexOf("html5fallback")&&0===jQuery("link[href*='"+file.url.slice(-30)+"']").length)return jQuery("head").append('<link rel="stylesheet" href="'+file.url+'"/>')});var minicolorsItems,queueJs=nobossmodal.loadJs.map(function(file){if(-1===file.url.indexOf("html5fallback")&&0===jQuery("script[src*='"+file.url.slice(-30)+"']").length)return jQuery("head").append('<script src="'+file.url+'" '+file.defer+" "+file.module+"><\/script>")});void 0!==majorVersionJoomla&&"3"==majorVersionJoomla&&(queueJs.join("|").indexOf("minicolors.min.js")>0&&(minicolorsItems=modalElem.find("input.minicolors")).removeClass("minicolors"));jQuery.when.apply(null,queueJs).done(function(){void 0!==majorVersionJoomla&&"3"==majorVersionJoomla&&(minicolorsItems&&minicolorsItems.addClass("minicolors"),jQuery(document).trigger("subform-row-add",modalElem)),void 0!==majorVersionJoomla&&"4"==majorVersionJoomla&&0==nobossmodal.blockModal&&jQuery("[data-showon]").length>0&&Joomla.Showon.initialise(document),1==nobossmodal.blockModal&&(jQuery(modalElem).find('[data-id="button-confirm"]').hide(),jQuery(modalElem).find('[data-id="button-reset"]').hide()),"undefined"!=typeof blockfields&&"undefined"!=typeof nobosslicense&&void 0!=nobosslicense.licenseInfo&&blockfields.blocksLicense("modal"),jQuery(modalElem).find(".joomla-editor-tinymce").length>0&&Joomla.JoomlaTinyMCE.setupEditors(document),util.activateYesno(modalElem),util.activateSelect(modalElem),util.activatePopover(modalElem),util.activateRange(modalElem),util.activateFontList(modalElem),util.activateMinicolors(modalElem,nobossmodal.infos.lowerJVersion),util.activateMedia(modalElem),util.activateCalendars(modalElem),util.activateMultipleInputs(modalElem)})},openModal:function(modalElem){modalElem.find("[name=nb-modal-form]").find("[data-tab-id]").each(function(){var thisTab=jQuery(this).closest(".nb-modal-content").find("[data-id=modal-nav-tabs]").find('[aria-controls="'+jQuery(this).data("tab-id")+'"]');if(jQuery(this).data("nbshowon")){var context=jQuery(this).data("nbshowon").split(";"),fieldInfo=context[context.length-1].split(":"),values=fieldInfo[fieldInfo.length-1].split(","),equals=!0;if("!"===fieldInfo[0].slice(-1)&&(fieldInfo[0]=fieldInfo[0].slice(0,-1),equals=!1),"outside"==context[0])nameContext=jQuery(this).closest(".control-group").closest(".controls").children("input[type=hidden][name^=jform]").attr("name"),fieldName=nameContext.replace(/\[[^\[\]]+\](?=[^\[\]]*$)/,"["+fieldInfo[0]+"]");else{if("inner"==context[0]){modalRawName=modalElem.data("modal-name"),fieldName=modalRawName+"\\["+fieldInfo[0]+"\\]";var field=jQuery("[name="+fieldName+"]");if(!field.data("has-nbshowon-event-"+jQuery(this).data("tab-id"))){jQuery(field).on("change",function(event){nobossmodal.validateAndChangeTab(equals,jQuery(this).val(),values,thisTab)});var innerFieldValue=field.val();"radio"==field.attr("type")&&(innerFieldValue=field.filter(":checked").val()),nobossmodal.validateAndChangeTab(equals,innerFieldValue,values,thisTab),field.each(function(){field.data("has-nbshowon-event-"+jQuery(this).data("tab-id"),!0)})}return!0}modalRawName=modalElem.data("modal-name"),fieldName=modalElem.siblings("[type=hidden]").attr("name").replace(modalRawName,fieldInfo[0])}var formattedName=fieldName.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),value=jQuery("[name='"+formattedName+"']").val();"radio"==jQuery("[name='"+formattedName+"']").attr("type")&&(value=jQuery("[name='"+formattedName+"']:checked").val()),nobossmodal.validateAndChangeTab(equals,value,values,thisTab),jQuery(this).closest(".nb-modal-content").find("[data-id=modal-nav-tabs]").find("[aria-controls]").each(function(){if("none"!==jQuery(this).css("display"))return jQuery(this).trigger("click"),!1})}}),nobossmodal.toogleBodyBackgroundFade(!0),modalElem.removeClass("nb-hidden").addClass("nb-show")},validateAndChangeTab:function(equals,value,values,tab){equals&&jQuery.inArray(value,values)>-1||!equals&&-1==jQuery.inArray(value,values)?tab.show():tab.hide()},tabNavigation:function(event){var tabToOpen,modalElem;event.preventDefault(),modalElem=jQuery(this).closest('[data-id="modal"]'),void 0!==majorVersionJoomla&&"3"==majorVersionJoomla?(tabToOpen=jQuery(this).attr("href").replace("#",""),jQuery(this).closest(".nav").find("[data-id=modal-tab]").removeAttr("active"),jQuery(this).attr("active","1")):(tabToOpen=jQuery(this).attr("aria-controls"),jQuery(this).closest("joomla-tab").find("button").removeAttr("aria-expanded"),jQuery(this).attr("aria-expanded","true")),modalElem.find("[data-id=nb-modal-form] [data-tab-id]").removeClass("active"),modalElem.find("[data-id=nb-modal-form]").find("[data-tab-id="+tabToOpen+"]").addClass("active")},confirmModal:function(event){event.preventDefault();var modalElem=jQuery(this).closest('[data-id="modal"]'),jsonValue=nobossmodal.generateJsonValue(modalElem);jQuery(modalElem).siblings('[data-id="noboss-modal-input-hidden"]').val(jsonValue),jQuery(modalElem).addClass("nb-hidden").removeClass("nb-show"),nobossmodal.toogleBodyBackgroundFade(!1)},cancelModal:function(event){event.preventDefault();var modalElem=jQuery(this).closest('[data-id="modal"]'),oldValue=jQuery(modalElem).siblings("[data-id=noboss-modal-input-hidden]").val(),newValue=nobossmodal.generateJsonValue(modalElem);oldValue.length>0&&newValue!==oldValue&&0==nobossmodal.blockModal?jQuery.confirm({title:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CANCEL_LABEL,content:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CANCEL_DESC,type:"blue",closeIcon:"cancel",escapeKey:"cancel",buttons:{cancel:{keys:["esc"],text:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CONFIRM_CANCEL_BUTTON},confirm:{text:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CONFIRM_CONFIRM_BUTTON,btnClass:"btn-blue",keys:["enter"],action:function(){jQuery(modalElem).siblings("script").remove(),jQuery(modalElem).remove(),nobossmodal.toogleBodyBackgroundFade(!1)}}}}):(jQuery(modalElem).siblings("script").remove(),jQuery(modalElem).remove(),nobossmodal.toogleBodyBackgroundFade(!1))},resetModal:function(event){event.preventDefault();var modalElem=jQuery(this).closest('[data-id="modal"]');jQuery.confirm({title:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_RESET_LABEL,content:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_RESET_DESC,type:"blue",closeIcon:"cancel",escapeKey:"cancel",buttons:{cancel:{keys:["esc"],text:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CONFIRM_CANCEL_BUTTON},confirm:{text:translationConstants.nobossmodal.LIB_NOBOSS_FIELD_NOBOSSMODAL_MODAL_CONFIRM_CONFIRM_BUTTON,btnClass:"btn-blue",keys:["enter"],action:function(){var oldValue=jQuery(modalElem).siblings("[data-id=noboss-modal-input-hidden]").val();jQuery(modalElem).siblings("[data-id=noboss-modal-input-hidden]").val(""),jQuery(modalElem).siblings("script").remove();var modalName=jQuery(modalElem).siblings("[data-id=noboss-modal-input-hidden]").data("modal-name"),xmlPath=jQuery(modalElem).siblings("[data-id=noboss-modal-input-hidden]").data("formsource");jQuery(modalElem).find(".nb-modal-content").append('<div class="loader-fade"></div>'),jQuery(modalElem).find(".nb-modal-content").append('<div class="loader loader--fullpage"></div>'),nobossmodal.ajaxAndInsertModal(jQuery(modalElem),"",modalName,xmlPath).done(function(response){var newModal=jQuery(modalElem).siblings('[data-id="modal"]');jQuery(newModal).siblings("[data-id=noboss-modal-input-hidden]").val(oldValue),setTimeout(function(){jQuery(modalElem).remove(),nobossmodal.openModal(newModal)},500)})}}}})},generateJsonValue:function(modalElem){var form=jQuery(modalElem).find("form"),modalName=modalElem.data("modal-name"),formData=form.serializeArray(),data={};return jQuery(formData).each(function(index,obj){var regex=new RegExp(modalName+"\\[(.*?)\\]");if(obj.name=obj.name.split(regex).join(""),/.*\[.*\].*/.test(obj.name)){var arrayName=obj.name.split("[")[0],arrayNameKey=obj.name.split(/\[(.*?)\]/)[1];if(void 0===data[arrayName]&&(data[arrayName]=arrayNameKey?{}:[]),arrayNameKey)if(void 0!==data[arrayName][arrayNameKey])if(Array.isArray(data[arrayName][arrayNameKey]))data[arrayName][arrayNameKey].push(obj.value);else{var temp=data[arrayName][arrayNameKey];data[arrayName][arrayNameKey]=[],data[arrayName][arrayNameKey].push(temp),data[arrayName][arrayNameKey].push(obj.value)}else data[arrayName][arrayNameKey]=obj.value;else data[arrayName].push(obj.value)}else data[obj.name]=obj.value}),JSON.stringify(data)},toogleBodyBackgroundFade:function(state){state?jQuery("body").addClass("modal--is-open"):(jQuery("body").removeClass("modal--is-open"),jQuery(document).trigger("modalClosed"))}};