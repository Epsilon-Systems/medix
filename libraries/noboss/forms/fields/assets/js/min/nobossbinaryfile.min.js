jQuery(document).ready(function($){binaryFile.CONSTRUCTOR()});var binaryFile={CONSTRUCTOR:function(){var contextsFileUpload=jQuery(".file-upload-context");contextsFileUpload.on("change",'input[data-id="upload-binary"]',function(event){binaryFile.alterFile(jQuery(this))}),contextsFileUpload.on("focusout",'[data-id="seeFile"]',function(event){jQuery(this).closest(".file-upload-context").find(".tooltip-image").addClass("hidden")}),contextsFileUpload.on("click","[data-id='deleteFile']",function(event){event.preventDefault();var linkContext=jQuery(this).closest(".file-upload-context");linkContext.find("[data-id='upload-binary-img']").val(""),linkContext.find("[data-id='upload-binary-img']").addClass("hidden"),linkContext.find("[data-id='upload-binary']").val(""),linkContext.find("[data-id='upload-binary-hidden']").val(""),linkContext.find("[data-id='file-options']").addClass("hidden")}),jQuery(".file-upload-context").on("click","a[data-id=seeFile]",binaryFile.imgBtnActivate),jQuery.event.trigger({type:"binnaryFileRequisitionEnds"})},alterFile:function(input){if(""!==input.val()){var fieldName=input.attr("name"),inputContext=input.closest(".file-upload-context");inputContext.siblings("div[data-field='error_"+fieldName+"']").remove(),input.attr("disabled",!0);var fileOptions=inputContext.find("[data-id='file-options']");fileOptions.addClass("hidden");var uploadFile=jQuery("[data-id='upload-binary']"),archive=input[0].files[0],data=new FormData;data.append("formFile",archive),data.append("dataParamsField",uploadFile.attr("data-params-field")),data.append("accept",uploadFile.attr("accept"));var url=input.attr("data-url"),imgThumb=inputContext.find("[data-id='upload-binary-img']");imgThumb.addClass("hidden"),jQuery.ajax({url:baseNameUrl+url,data:data,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(dataReturn){if(dataReturn=jQuery.parseJSON(dataReturn),inputContext.trigger("binnaryFileRequisitionEnds"),dataReturn.hasOwnProperty("error"))0===jQuery("div[data-field='error_"+fieldName+"']").length&&jQuery("<div data-field='error_"+fieldName+"' class='alert alert-danger'>"+dataReturn.error+"</div>").insertAfter(inputContext);else{var inputStringFile=input.siblings("input[data-id=upload-binary-hidden]");binaryFile.verifyType(dataReturn.mimeTypeFile,"image")?(imgThumb.attr("src",dataReturn.imageSrcDisplay),imgThumb.removeClass("hidden")):imgThumb.addClass("hidden");var fieldValue={stringFile:dataReturn.stringFile,mimeTypeFile:dataReturn.mimeTypeFile},jsonFieldValue=JSON.stringify(fieldValue);inputStringFile.val(jsonFieldValue),inputStringFile.attr("mime",dataReturn.mimeTypeFile),fileOptions.removeClass("hidden")}input.removeAttr("disabled",!0)}})}},verifyType:function(mimeTypeFile,typeSearch){return-1!=mimeTypeFile.search(typeSearch)},imgBtnDesactivate:function(event){event.stopPropagation(),binaryFile.nowThis.siblings(".tooltip-image").addClass("hidden"),binaryFile.nowThis={},jQuery("html").off("click","body",binaryFile.imgBtnDesactivate)},imgBtnActivate:function(event){event.preventDefault(),event.stopPropagation();var linkSeeFile=jQuery(this),linkContext=linkSeeFile.closest(".file-upload-context"),tooltipImage=linkContext.find(".tooltip-image"),inputValue=linkContext.find("input[data-id=upload-binary-hidden]").val(),dataFile=jQuery.parseJSON(inputValue),stringFile=dataFile.stringFile,mimeTypeFile=dataFile.mimeTypeFile;binaryFile.verifyType(mimeTypeFile,"image")?tooltipImage.hasClass("hidden")?tooltipImage.removeClass("hidden"):tooltipImage.addClass("hidden"):binaryFile.displayFile(mimeTypeFile,stringFile),jQuery("html").off("click","body",binaryFile.imgBtnDesactivate),jQuery("html").on("click","body",binaryFile.imgBtnDesactivate),binaryFile.nowThis=linkSeeFile},displayFile:function(mimeTypeFile,stringFileEncodedBase64){if(binaryFile.detectIE()){var fullUrl=baseNameUrl+"index.php?option=com_nobossajax&library=noboss.file.binaryfromfile&method=viewFile",inputFileUploaded=jQuery("[data-id='upload-binary-hidden']").clone();inputFileUploaded.attr("name","fileUploadedData");var formToViewFile=jQuery("<form name='form_to_view_file' style='margin: 0; padding: 0;' target='_blank' method='POST' enctype='multipart/form-data' action='"+fullUrl+"'></form>");formToViewFile.insertBefore(inputFileUploaded),formToViewFile.append(inputFileUploaded),formToViewFile.submit(),formToViewFile.remove()}else window.open("data:"+mimeTypeFile+";base64,"+stringFileEncodedBase64)},detectIE:function(){var userAgent=window.navigator.userAgent,msie=userAgent.indexOf("MSIE ");if(msie>0)return parseInt(userAgent.substring(msie+5,userAgent.indexOf(".",msie)),10);if(userAgent.indexOf("Trident/")>0){var rv=userAgent.indexOf("rv:");return parseInt(userAgent.substring(rv+3,userAgent.indexOf(".",rv)),10)}var edge=userAgent.indexOf("Edge/");return edge>0&&parseInt(userAgent.substring(edge+5,userAgent.indexOf(".",edge)),10)}};